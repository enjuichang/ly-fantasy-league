name: Refresh Rollcall Data

on:
  schedule:
    # Run at 6:00 AM and 6:00 PM UTC daily
    - cron: '0 6,18 * * *'
  workflow_dispatch: # Allow manual triggering

jobs:
  refresh-rollcall:
    runs-on: ubuntu-latest
    steps:
      - name: Sync Rollcall Votes (Batch 1/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=0" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 2/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=1" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 3/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=2" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 4/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=3" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 5/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=4" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 6/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=5" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 7/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=6" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 8/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=7" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 9/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=8" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 10/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=9" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 11/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=10" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 12/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=11" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 13/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=12" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 14/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=13" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 15/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=14" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 16/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=15" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 17/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=16" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 18/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=17" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 19/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=18" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail

      - name: Sync Rollcall Votes (Batch 20/20)
        run: |
          curl -X GET "${{ secrets.APP_URL }}/api/refresh-data?type=rollcall&rollcall_limit=1&rollcall_offset=19" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail
